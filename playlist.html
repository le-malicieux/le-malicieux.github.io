<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8"><title>Ma Playlist</title>
    <style>
        :root { --primary: #ff4757; --bg: #0f0f0f; --text: #eee; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; }
        .header { padding: 20px; background: rgba(255,255,255,0.05); display: flex; align-items: center; gap: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 15px; padding: 20px; }
        .card { background: #1a1a1a; border-radius: 8px; overflow: hidden; border: 1px solid #333; text-decoration: none; color: inherit; font-size: 0.8em; }
        .card img { width: 100%; height: 230px; object-fit: cover; }
        .card-info { padding: 10px; }
        .btn-red { background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 5px; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header"><a href="index.html" class="btn-red">‚Üê Accueil</a><h1>Ma Playlist</h1></div>
    <div id="playlist-grid" class="grid"></div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyCD70a-QR2nJnHBnA-FUoIGHZ7Z3VByPMk", authDomain: "le-malicieux-v2.firebaseapp.com", projectId: "le-malicieux-v2", storageBucket: "le-malicieux-v2.firebasestorage.app", messagingSenderId: "938147445933", appId: "1:938147445933:web:86f9c65ee0737e66a9da24" };
        const app = initializeApp(firebaseConfig); const auth = getAuth(app); const db = getFirestore(app);

        onAuthStateChanged(auth, async (u) => {
            if (!u) { window.location.href = "index.html"; return; }
            const q = query(collection(db, "playlists"), where("uid", "==", u.uid));
            const s = await getDocs(q); const c = document.getElementById('playlist-grid');
            s.forEach(d => {
                const data = d.data(); if(data.status === "none") return;
                c.innerHTML += `<a href="video.html?name=${encodeURIComponent(data.anime)}" class="card"><img src="img/${data.img}"><div class="card-info"><b>${data.anime}</b><br>Ma note: ${data.rating}/10</div></a>`;
            });
        });
    </script>
</body>
</html>
